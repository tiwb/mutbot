# UI 暗色主题与布局改造 设计规范

**状态**：✅ 已完成
**日期**：2026-02-24
**类型**：功能设计

## 1. 背景

MutBot Web UI 原使用自定义紫色/深蓝配色方案，与主流 IDE 视觉体验差异较大。经过多轮迭代，完成了暗色主题改造、标签页样式优化、侧边栏双模式、右键菜单等功能。

## 2. 最终设计方案

### 2.1 配色方案

采用深灰色调暗色主题，纯色区分各区域，不使用分割线：

| CSS 变量 | 色值 | 用途 |
|----------|------|------|
| `--bg` | `#1F1F1F` | 面板背景 / 活动标签背景 |
| `--bg-sidebar` | `#1F1F1F` | 侧边栏背景 |
| `--tab-inactive-bg` | `#262526` | 标签栏背景 / 非活动标签 / 分割区 |
| `--tab-active-bg` | `#1F1F1F` | 活动标签背景（与面板同色） |
| `--tab-hover-bg` | `#1F1F1F` | 标签悬停背景 |
| `--tab-border` | `#262526` | 分割区（侧边栏/面板间） |
| `--accent` | `#007ACC` | 焦点色（hover 高亮、拖拽高亮） |
| `--text` | `#CCCCCC` | 主文本 |
| `--text-dim` | `#858585` | 次要文本 |
| `--error` | `#F14C4C` | 错误色 |
| `--warning` | `#CCA700` | 警告色 |
| `--success` | `#4EC9B0` | 成功色 |

### 2.2 布局区域与视觉分隔

所有区域通过纯色背景区分，不使用线条分割：

- **标签栏** `#262526` — 与非活动标签同色
- **活动标签** `#1F1F1F` — 与面板同色，视觉上融为一体
- **面板分割区** 4px `#262526` — 与标签栏同色，hover/拖拽时蓝色高亮
- **侧边栏分割区** 4px `#262526` — 可拖拽调整侧边栏宽度

### 2.3 标签页样式

- 高度 35px，无圆角
- 活动/非活动通过背景色区分，无 border
- 关闭按钮仅 hover 或选中时显示
- 标签页图标通过 `onRenderTab` 注入 SVG（消息气泡/终端/文件）
- 首个标签左侧无间距

### 2.4 终端配色

xterm.js 主题使用标准暗色 ANSI 配色（含 bright 系列），背景 `#1E1E1E`。

### 2.5 Session 侧边栏双模式

- **完整模式**（默认 260px，可拖拽调整）：显示 session 列表（图标 + 标题 + 状态）
- **精简模式**（48px）：仅显示活动 session 图标
- 顶部切换按钮，状态持久化到 localStorage
- 侧边栏作为独立 div 渲染（不在 flexlayout border 内）

### 2.6 右键上下文菜单

通用 `ContextMenu` 组件，覆盖四个区域：
- Session 列表：Close Session / Delete
- 标签页：Close / Close Others
- 消息区域：Copy / Select All
- 终端：Copy / Paste / Clear Terminal

### 2.7 代码高亮

Shiki 主题使用 `dark-plus`。

## 3. 实施步骤清单

### 阶段一：配色系统重构 [✅ 已完成]
- [x] CSS 变量重映射为暗色主题色值
- [x] 全局样式更新（滚动条、输入框、对话框）
- [x] Shiki 主题切换为 dark-plus

### 阶段二：标签页样式 [✅ 已完成]
- [x] 标签栏高度 35px，活动/非活动标签纯色区分
- [x] 标签页图标注入
- [x] 面板分割区 4px 纯色 + hover/拖拽高亮

### 阶段三：终端配色 [✅ 已完成]
- [x] xterm.js ANSI 颜色更新（含 bright 系列）

### 阶段四：Session 侧边栏双模式 [✅ 已完成]
- [x] 精简模式（48px 图标）+ 完整模式（可调宽度）
- [x] 切换按钮 + localStorage 持久化
- [x] 侧边栏从 flexlayout border 迁移为独立 div

### 阶段五：右键上下文菜单 [✅ 已完成]
- [x] ContextMenu 通用组件
- [x] Session 列表 / 标签页 / 消息区 / 终端 四处菜单
